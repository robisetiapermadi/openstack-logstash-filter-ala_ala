  filter {
      if [fields][log_type] == "syslog" {
        mutate {
          add_tag => [ "syslog" ]
        }
    
      }

      if [fields][log_type] == "auth" {
        mutate {
          add_tag => [ "auth" ]
        }

        # 2021-11-29 14:51:49.2240

        grok {
          match => { "message" => "%{TIMESTAMP_ISO8601:system.timestamp}"}
        }

        date {
          match => [ "system.timestamp" , "ISO8601" ]
        }

        grok {
          match => { "message" => "%{TIMESTAMP_ISO8601:temp} %{DATA:system.program}\[%{POSINT:system.pid}\]"}
          remove_field => [ "temp" ]
        }

        if [system.program] =="sshd"{
            grok {
              patterns_dir   => ["etc/logstash/patterns.d"]
              match => { "message" => "%{SSH_AUTH_SUCCESS}" }
              add_field => { "system.auth.result" => "success" "system.auth.type" => "login" }
              add_tag => [ "_grok_sshd_success", "matched" ]
              remove_field => [ "temp" ]
            }
            grok {
              patterns_dir   => ["etc/logstash/patterns.d"]
              match => { "message" => "%{SSH_AUTHFAIL_WRONGCREDS}" }
              add_field => { "system.auth.result" => "fail" "system.auth.fail.reason" => "wrong_credentials" }
              add_tag => [ "_grok_sshd_success", "matched" ]
            }
            grok {
              patterns_dir   => ["etc/logstash/patterns.d"]
              match => { "message" => "%{SSH_AUTHFAIL_WRONGUSER}" }
              add_field => { "system.auth.result" => "fail" "system.auth.fail.reason" => "unknown_user" }
              add_tag => [ "_grok_sshd_success", "matched" ]
            }
            grok {
              patterns_dir   => ["etc/logstash/patterns.d"]
              match => { "message" => "%{SSH_DISCONNECT}" }
              add_field => { "system.auth.result" => "success" "system.auth.type" => "logout" }
              add_tag => [ "_grok_sshd_success", "matched", "ssh_disconnect" ]
              remove_field => [ "temp" ]
            }
            mutate {
              remove_tag => [ "matched", "_grokparsefailure" ]
            }
        }
      }
  }
